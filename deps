<dependency>
      <groupId>org.apache.logging.log4j</groupId>
      <artifactId>log4j-layout-template-json</artifactId>
</dependency>
    

String traceId =System.getenv().getOrDefault("_X_AMZN_TRACE_ID","NA").replace("Root=","");
            String correlationId =traceId.split(";")[0];
            MDC.put("traceId",traceId.replace("Root=",""));
            MDC.put("correlationId",correlationId);
            MDC.put("requestId",context.getAwsRequestId());
            MDC.put("compositeUserId", "a@b@brand");

            logger.info("Incoming request to authorize token");
            logger.info("Authorize process completed");
            MDC.clear();

<dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-bom</artifactId>
        <version>2.19.0</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>
  
  {
    "timestamp": "2023-03-27T08:23:35.078Z",
    "level": "INFO",
    "contextMap": {
        "compositeUserId": "a@b@brand",
        "correlationId": "1-64215281-4e35168d5b8cb2f773061586",
        "requestId": "4e8b04c4-2298-4fcb-a788-23f2054ad3ff",
        "traceId": "1-64215281-4e35168d5b8cb2f773061586;Parent=9b9383083d7a681b;Sampled=1"
    },
    "message": "Incoming request to authorize token"
}

https://elvisciotti.medium.com/logback-non-access-spring-logs-with-custom-json-format-and-mdc-1c6f1fbf28c4

helm upgrade istiod manifests/charts/istio-control/istio-discovery --namespace istio-system --values values_backup.yaml

    
{"bytes_rcvd":0,"upstream_host":"10.244.0.6:8888","user_agent":"curl/7.81.0","host":"172.18.255.200","protocol":"HTTP/1.1","remote_address":"10.244.0.8:34858","request":{"request_method":"GET","request_id":"3e2a7759-3bfd-4284-a80e-8f04ee4eb19e","request_xff":"10.244.0.1","request_time":510,"request_path":"/hello"},"compositeUserId":"123456","start_time":"2023-03-31T07:54:51.230Z","source_host":"java-app-default-5f878c5f4f-tqxst","response":{"response_time":504,"response_bytes_sent":25,"response_flags":"-","response_upstream_time":"502","response_code":200,"response_code_details":"via_upstream"},"correlationId":"654321"}    
